# %%
import csv
import math
import random
import numpy as np
import pandas as pd
from sklearn import neighbors
from sklearn.model_selection import StratifiedKFold, cross_val_score
from sklearn.neighbors import KNeighborsClassifier
import matplotlib.pyplot as plt
from sklearn.svm import SVC
# %%
train = pd.read_csv("../data/processed/train.csv")
test = pd.read_csv("../data/processed/test.csv")
print(test.head())
# %%
train = train.drop(["id"], axis=1)
test = test.drop(["id"], axis=1)
print(train.head())
print(test.head())
# %%
# Split the data into X (features) and y (labels)
X_train = train.drop(["label"], axis=1)
y_train = train["label"]
y_train = y_train - 1
y_test = test["label"] - 1
X_test = test.drop(["label"], axis=1)
# %%
def highCorrFeat(dataframe, threshold):
    """
    Identify highly correlated feature pairs and features to drop based on a given correlation threshold.
    
    Parameters:
    dataframe (pd.DataFrame): The input dataframe containing the features.
    threshold (float): The correlation threshold to determine which features are highly correlated. Default is 0.9.
    
    Returns:
    dict: A dictionary of highly correlated feature pairs with their correlation values.
    list: A list of feature columns to drop based on the correlation threshold.
    """
    # Step 1: Calculate the correlation matrix
    correlation_matrix = dataframe.corr().abs()

    # Step 2: Create a mask for the upper triangle
    upper_tri = correlation_matrix.where(np.triu(np.ones(correlation_matrix.shape), k=1).astype(bool))

    # Step 3: Extract the pairs of highly correlated features
    high_corr_pairs = [(column, row) for column in upper_tri.columns for row in upper_tri.index if upper_tri.loc[row, column] > threshold]

    # Step 4: Store the highly correlated pairs in a dictionary
    res = {}
    for pair in high_corr_pairs:
        corr = correlation_matrix.loc[pair[0], pair[1]]
        res[corr] = [pair[0], pair[1]]

    # Step 5: Find the feature columns that have a correlation greater than the threshold
    to_drop = [column for column in upper_tri.columns if any(upper_tri[column] > threshold)]
    
    return res, to_drop
# %%
res_9, to_drop_9 = highCorrFeat(X_train, 0.9)
res_8, to_drop_8 = highCorrFeat(X_train, 0.8)
# %%
# Drop the features from both the training and testing set
train_9 = train.drop(columns=to_drop_9)
test_9 = test.drop(columns=to_drop_9)
train_8 = train.drop(columns=to_drop_8)
test_8 = test.drop(columns=to_drop_8)
train_9.to_csv("../data/processed/train_9.csv", index=False)
test_9.to_csv("../data/processed/test_9.csv", index=False)
train_8.to_csv("../data/processed/train_8.csv", index=False)
test_8.to_csv("../data/processed/test_8.csv", index=False)
# %%
res_9_df = pd.DataFrame(list(res_9.items()), columns=["Correlation Coefficients", "Feature Pairs"])
res_8_df = pd.DataFrame(list(res_8.items()), columns=["Correlation Coefficients", "Feature Pairs"])
res_9_df.to_csv("high_corr_features_9.csv", index=False)
res_8_df.to_csv("high_corr_features_8.csv", index=False)

# %%
# Display the results
print("Dropped features:", to_drop_9)
print("Dropped features:", to_drop_8)
print("Original Dataframe shape: ", train.shape)
print("Reduced DataFrame shape of threshold = 0.9:", train_9.shape)
print("Reduced DataFrame shape of threshold = 0.9:", train_8.shape)

# Dropped features: ['tBodyAcc-Mad-1', 'tBodyAcc-Mad-2', 'tBodyAcc-Mad-3', 'tBodyAcc-Max-1', 'tBodyAcc-Max-2', 'tBodyAcc-Max-3', 'tBodyAcc-Min-1', 'tBodyAcc-Min-2', 'tBodyAcc-SMA-1', 'tBodyAcc-Energy-1', 'tBodyAcc-IQR-1', 'tBodyAcc-IQR-2', 'tBodyAcc-IQR-3', 'tGravityAcc-Mad-1', 'tGravityAcc-Mad-2', 'tGravityAcc-Mad-3', 'tGravityAcc-Max-1', 'tGravityAcc-Max-2', 'tGravityAcc-Max-3', 'tGravityAcc-Min-1', 'tGravityAcc-Min-2', 'tGravityAcc-Min-3', 'tGravityAcc-Energy-1', 'tGravityAcc-IQR-1', 'tGravityAcc-IQR-2', 'tGravityAcc-IQR-3', 'tGravityAcc-ARCoeff-2', 'tGravityAcc-ARCoeff-3', 'tGravityAcc-ARCoeff-4', 'tGravityAcc-ARCoeff-6', 'tGravityAcc-ARCoeff-7', 'tGravityAcc-ARCoeff-8', 'tGravityAcc-ARCoeff-10', 'tGravityAcc-ARCoeff-11', 'tGravityAcc-ARCoeff-12', 'tBodyAccJerk-STD-1', 'tBodyAccJerk-STD-2', 'tBodyAccJerk-STD-3', 'tBodyAccJerk-Mad-1', 'tBodyAccJerk-Mad-2', 'tBodyAccJerk-Mad-3', 'tBodyAccJerk-Max-1', 'tBodyAccJerk-Max-2', 'tBodyAccJerk-Max-3', 'tBodyAccJerk-Min-1', 'tBodyAccJerk-Min-2', 'tBodyAccJerk-Min-3', 'tBodyAccJerk-SMA-1', 'tBodyAccJerk-Energy-1', 'tBodyAccJerk-Energy-2', 'tBodyAccJerk-Energy-3', 'tBodyAccJerk-IQR-1', 'tBodyAccJerk-IQR-2', 'tBodyAccJerk-IQR-3', 'tBodyAccJerk-ropy-1', 'tBodyAccJerk-ropy-1.1', 'tBodyAccJerk-ropy-1.2', 'tBodyAccJerk-ARCoeff-1', 'tBodyAccJerk-ARCoeff-5', 'tBodyAccJerk-ARCoeff-9', 'tBodyGyro-STD-3', 'tBodyGyro-Mad-1', 'tBodyGyro-Mad-2', 'tBodyGyro-Mad-3', 'tBodyGyro-Max-2', 'tBodyGyro-Max-3', 'tBodyGyro-Min-1', 'tBodyGyro-Min-2', 'tBodyGyro-Min-3', 'tBodyGyro-SMA-1', 'tBodyGyro-Energy-1', 'tBodyGyro-Energy-2', 'tBodyGyro-Energy-3', 'tBodyGyro-IQR-1', 'tBodyGyro-IQR-2', 'tBodyGyro-IQR-3', 'tBodyGyro-ARCoeff-2', 'tBodyGyro-ARCoeff-10', 'tBodyGyroJerk-STD-1', 'tBodyGyroJerk-STD-2', 'tBodyGyroJerk-STD-3', 'tBodyGyroJerk-Mad-1', 'tBodyGyroJerk-Mad-2', 'tBodyGyroJerk-Mad-3', 'tBodyGyroJerk-Max-1', 'tBodyGyroJerk-Max-2', 'tBodyGyroJerk-Max-3', 'tBodyGyroJerk-Min-1', 'tBodyGyroJerk-Min-2', 'tBodyGyroJerk-Min-3', 'tBodyGyroJerk-SMA-1', 'tBodyGyroJerk-Energy-1', 'tBodyGyroJerk-Energy-3', 'tBodyGyroJerk-IQR-1', 'tBodyGyroJerk-IQR-2', 'tBodyGyroJerk-IQR-3', 'tBodyGyroJerk-ropy-1', 'tBodyGyroJerk-ropy-1.1', 'tBodyGyroJerk-ropy-1.2', 'tBodyGyroJerk-ARCoeff-1', 'tBodyGyroJerk-ARCoeff-5', 'tBodyGyroJerk-ARCoeff-9', 'tBodyAccMag-Mean-1', 'tBodyAccMag-STD-1', 'tBodyAccMag-Mad-1', 'tBodyAccMag-Max-1', 'tBodyAccMag-SMA-1', 'tBodyAccMag-Energy-1', 'tBodyAccMag-IQR-1', 'tBodyAccMag-ropy-1', 'tBodyAccMag-ARCoeff-2', 'tGravityAccMag-Mean-1', 'tGravityAccMag-STD-1', 'tGravityAccMag-Mad-1', 'tGravityAccMag-Max-1', 'tGravityAccMag-Min-1', 'tGravityAccMag-SMA-1', 'tGravityAccMag-Energy-1', 'tGravityAccMag-IQR-1', 'tGravityAccMag-ropy-1', 'tGravityAccMag-ARCoeff-1', 'tGravityAccMag-ARCoeff-2', 'tGravityAccMag-ARCoeff-3', 'tGravityAccMag-ARCoeff-4', 'tBodyAccJerkMag-Mean-1', 'tBodyAccJerkMag-STD-1', 'tBodyAccJerkMag-Mad-1', 'tBodyAccJerkMag-Max-1', 'tBodyAccJerkMag-SMA-1', 'tBodyAccJerkMag-Energy-1', 'tBodyAccJerkMag-IQR-1', 'tBodyAccJerkMag-ropy-1', 'tBodyGyroMag-Mean-1', 'tBodyGyroMag-STD-1', 'tBodyGyroMag-Mad-1', 'tBodyGyroMag-Max-1', 'tBodyGyroMag-SMA-1', 'tBodyGyroMag-Energy-1', 'tBodyGyroMag-IQR-1', 'tBodyGyroMag-ARCoeff-2', 'tBodyGyroJerkMag-Mean-1', 'tBodyGyroJerkMag-STD-1', 'tBodyGyroJerkMag-Mad-1', 'tBodyGyroJerkMag-Max-1', 'tBodyGyroJerkMag-SMA-1', 'tBodyGyroJerkMag-Energy-1', 'tBodyGyroJerkMag-IQR-1', 'tBodyGyroJerkMag-ropy-1', 'fBodyAcc-Mean-1', 'fBodyAcc-Mean-2', 'fBodyAcc-Mean-3', 'fBodyAcc-STD-1', 'fBodyAcc-STD-2', 'fBodyAcc-STD-3', 'fBodyAcc-Mad-1', 'fBodyAcc-Mad-2', 'fBodyAcc-Mad-3', 'fBodyAcc-Max-1', 'fBodyAcc-Max-2', 'fBodyAcc-Max-3', 'fBodyAcc-SMA-1', 'fBodyAcc-Energy-1', 'fBodyAcc-Energy-2', 'fBodyAcc-Energy-3', 'fBodyAcc-IQR-1', 'fBodyAcc-IQR-2', 'fBodyAcc-IQR-3', 'fBodyAcc-ropy-1', 'fBodyAcc-ropy-1.1', 'fBodyAcc-ropy-1.2', 'fBodyAcc-Kurtosis-1', 'fBodyAcc-Kurtosis-1.1', 'fBodyAcc-Kurtosis-1.2', 'fBodyAcc-BandsEnergyOld-1', 'fBodyAcc-BandsEnergyOld-2', 'fBodyAcc-BandsEnergyOld-9', 'fBodyAcc-BandsEnergyOld-10', 'fBodyAcc-BandsEnergyOld-11', 'fBodyAcc-BandsEnergyOld-12', 'fBodyAcc-BandsEnergyOld-13', 'fBodyAcc-BandsEnergyOld-14', 'fBodyAcc-BandsEnergyOld-15', 'fBodyAcc-BandsEnergyOld-16', 'fBodyAcc-BandsEnergyOld-17', 'fBodyAcc-BandsEnergyOld-23', 'fBodyAcc-BandsEnergyOld-24', 'fBodyAcc-BandsEnergyOld-25', 'fBodyAcc-BandsEnergyOld-26', 'fBodyAcc-BandsEnergyOld-27', 'fBodyAcc-BandsEnergyOld-28', 'fBodyAcc-BandsEnergyOld-29', 'fBodyAcc-BandsEnergyOld-31', 'fBodyAcc-BandsEnergyOld-37', 'fBodyAcc-BandsEnergyOld-38', 'fBodyAcc-BandsEnergyOld-39', 'fBodyAcc-BandsEnergyOld-40', 'fBodyAcc-BandsEnergyOld-41', 'fBodyAcc-BandsEnergyOld-42', 'fBodyAccJerk-Mean-1', 'fBodyAccJerk-Mean-2', 'fBodyAccJerk-Mean-3', 'fBodyAccJerk-STD-1', 'fBodyAccJerk-STD-2', 'fBodyAccJerk-STD-3', 'fBodyAccJerk-Mad-1', 'fBodyAccJerk-Mad-2', 'fBodyAccJerk-Mad-3', 'fBodyAccJerk-Max-1', 'fBodyAccJerk-Max-2', 'fBodyAccJerk-Max-3', 'fBodyAccJerk-SMA-1', 'fBodyAccJerk-Energy-1', 'fBodyAccJerk-Energy-2', 'fBodyAccJerk-Energy-3', 'fBodyAccJerk-IQR-1', 'fBodyAccJerk-IQR-2', 'fBodyAccJerk-IQR-3', 'fBodyAccJerk-ropy-1', 'fBodyAccJerk-ropy-1.1', 'fBodyAccJerk-ropy-1.2', 'fBodyAccJerk-MeanFreq-1', 'fBodyAccJerk-MeanFreq-3', 'fBodyAccJerk-Kurtosis-1', 'fBodyAccJerk-Kurtosis-1.1', 'fBodyAccJerk-Kurtosis-1.2', 'fBodyAccJerk-BandsEnergyOld-1', 'fBodyAccJerk-BandsEnergyOld-2', 'fBodyAccJerk-BandsEnergyOld-3', 'fBodyAccJerk-BandsEnergyOld-4', 'fBodyAccJerk-BandsEnergyOld-5', 'fBodyAccJerk-BandsEnergyOld-6', 'fBodyAccJerk-BandsEnergyOld-9', 'fBodyAccJerk-BandsEnergyOld-10', 'fBodyAccJerk-BandsEnergyOld-11', 'fBodyAccJerk-BandsEnergyOld-12', 'fBodyAccJerk-BandsEnergyOld-13', 'fBodyAccJerk-BandsEnergyOld-14', 'fBodyAccJerk-BandsEnergyOld-16', 'fBodyAccJerk-BandsEnergyOld-17', 'fBodyAccJerk-BandsEnergyOld-18', 'fBodyAccJerk-BandsEnergyOld-19', 'fBodyAccJerk-BandsEnergyOld-20', 'fBodyAccJerk-BandsEnergyOld-23', 'fBodyAccJerk-BandsEnergyOld-24', 'fBodyAccJerk-BandsEnergyOld-25', 'fBodyAccJerk-BandsEnergyOld-26', 'fBodyAccJerk-BandsEnergyOld-27', 'fBodyAccJerk-BandsEnergyOld-28', 'fBodyAccJerk-BandsEnergyOld-30', 'fBodyAccJerk-BandsEnergyOld-31', 'fBodyAccJerk-BandsEnergyOld-32', 'fBodyAccJerk-BandsEnergyOld-33', 'fBodyAccJerk-BandsEnergyOld-34', 'fBodyAccJerk-BandsEnergyOld-37', 'fBodyAccJerk-BandsEnergyOld-38', 'fBodyAccJerk-BandsEnergyOld-39', 'fBodyAccJerk-BandsEnergyOld-40', 'fBodyAccJerk-BandsEnergyOld-41', 'fBodyAccJerk-BandsEnergyOld-42', 'fBodyGyro-Mean-1', 'fBodyGyro-Mean-2', 'fBodyGyro-Mean-3', 'fBodyGyro-STD-1', 'fBodyGyro-STD-2', 'fBodyGyro-STD-3', 'fBodyGyro-Mad-1', 'fBodyGyro-Mad-2', 'fBodyGyro-Mad-3', 'fBodyGyro-Max-1', 'fBodyGyro-Max-2', 'fBodyGyro-Max-3', 'fBodyGyro-SMA-1', 'fBodyGyro-Energy-1', 'fBodyGyro-Energy-2', 'fBodyGyro-Energy-3', 'fBodyGyro-IQR-1', 'fBodyGyro-IQR-2', 'fBodyGyro-IQR-3', 'fBodyGyro-ropy-1', 'fBodyGyro-ropy-1.1', 'fBodyGyro-ropy-1.2', 'fBodyGyro-Kurtosis-1', 'fBodyGyro-Kurtosis-1.1', 'fBodyGyro-Kurtosis-1.2', 'fBodyGyro-BandsEnergyOld-1', 'fBodyGyro-BandsEnergyOld-2', 'fBodyGyro-BandsEnergyOld-3', 'fBodyGyro-BandsEnergyOld-8', 'fBodyGyro-BandsEnergyOld-9', 'fBodyGyro-BandsEnergyOld-10', 'fBodyGyro-BandsEnergyOld-11', 'fBodyGyro-BandsEnergyOld-12', 'fBodyGyro-BandsEnergyOld-13', 'fBodyGyro-BandsEnergyOld-14', 'fBodyGyro-BandsEnergyOld-15', 'fBodyGyro-BandsEnergyOld-17', 'fBodyGyro-BandsEnergyOld-23', 'fBodyGyro-BandsEnergyOld-24', 'fBodyGyro-BandsEnergyOld-25', 'fBodyGyro-BandsEnergyOld-26', 'fBodyGyro-BandsEnergyOld-27', 'fBodyGyro-BandsEnergyOld-28', 'fBodyGyro-BandsEnergyOld-29', 'fBodyGyro-BandsEnergyOld-31', 'fBodyGyro-BandsEnergyOld-37', 'fBodyGyro-BandsEnergyOld-38', 'fBodyGyro-BandsEnergyOld-39', 'fBodyGyro-BandsEnergyOld-40', 'fBodyGyro-BandsEnergyOld-41', 'fBodyGyro-BandsEnergyOld-42', 'fBodyAccMag-Mean-1', 'fBodyAccMag-STD-1', 'fBodyAccMag-Mad-1', 'fBodyAccMag-Max-1', 'fBodyAccMag-SMA-1', 'fBodyAccMag-Energy-1', 'fBodyAccMag-IQR-1', 'fBodyAccMag-ropy-1', 'fBodyAccMag-Kurtosis-1', 'fBodyAccJerkMag-Mean-1', 'fBodyAccJerkMag-STD-1', 'fBodyAccJerkMag-Mad-1', 'fBodyAccJerkMag-Max-1', 'fBodyAccJerkMag-SMA-1', 'fBodyAccJerkMag-Energy-1', 'fBodyAccJerkMag-IQR-1', 'fBodyAccJerkMag-ropy-1', 'fBodyAccJerkMag-Kurtosis-1', 'fBodyGyroMag-Mean-1', 'fBodyGyroMag-STD-1', 'fBodyGyroMag-Mad-1', 'fBodyGyroMag-Max-1', 'fBodyGyroMag-SMA-1', 'fBodyGyroMag-Energy-1', 'fBodyGyroMag-IQR-1', 'fBodyGyroMag-ropy-1', 'fBodyGyroMag-Kurtosis-1', 'fBodyGyroJerkMag-Mean-1', 'fBodyGyroJerkMag-STD-1', 'fBodyGyroJerkMag-Mad-1', 'fBodyGyroJerkMag-Max-1', 'fBodyGyroJerkMag-SMA-1', 'fBodyGyroJerkMag-Energy-1', 'fBodyGyroJerkMag-IQR-1', 'fBodyGyroJerkMag-ropy-1', 'fBodyGyroJerkMag-Kurtosis-1', 'tXAxisAcc-AngleWRTGravity-1', 'tYAxisAcc-AngleWRTGravity-1', 'tZAxisAcc-AngleWRTGravity-1']
# Dropped features: ['tBodyAcc-STD-2', 'tBodyAcc-STD-3', 'tBodyAcc-Mad-1', 'tBodyAcc-Mad-2', 'tBodyAcc-Mad-3', 'tBodyAcc-Max-1', 'tBodyAcc-Max-2', 'tBodyAcc-Max-3', 'tBodyAcc-Min-1', 'tBodyAcc-Min-2', 'tBodyAcc-Min-3', 'tBodyAcc-SMA-1', 'tBodyAcc-Energy-1', 'tBodyAcc-Energy-2', 'tBodyAcc-IQR-1', 'tBodyAcc-IQR-2', 'tBodyAcc-IQR-3', 'tBodyAcc-ropy-1.1', 'tBodyAcc-ARCoeff-2', 'tBodyAcc-ARCoeff-3', 'tBodyAcc-ARCoeff-6', 'tBodyAcc-ARCoeff-10', 'tGravityAcc-Mad-1', 'tGravityAcc-Mad-2', 'tGravityAcc-Mad-3', 'tGravityAcc-Max-1', 'tGravityAcc-Max-2', 'tGravityAcc-Max-3', 'tGravityAcc-Min-1', 'tGravityAcc-Min-2', 'tGravityAcc-Min-3', 'tGravityAcc-Energy-1', 'tGravityAcc-Energy-2', 'tGravityAcc-Energy-3', 'tGravityAcc-IQR-1', 'tGravityAcc-IQR-2', 'tGravityAcc-IQR-3', 'tGravityAcc-ARCoeff-2', 'tGravityAcc-ARCoeff-3', 'tGravityAcc-ARCoeff-4', 'tGravityAcc-ARCoeff-6', 'tGravityAcc-ARCoeff-7', 'tGravityAcc-ARCoeff-8', 'tGravityAcc-ARCoeff-10', 'tGravityAcc-ARCoeff-11', 'tGravityAcc-ARCoeff-12', 'tBodyAccJerk-STD-1', 'tBodyAccJerk-STD-2', 'tBodyAccJerk-STD-3', 'tBodyAccJerk-Mad-1', 'tBodyAccJerk-Mad-2', 'tBodyAccJerk-Mad-3', 'tBodyAccJerk-Max-1', 'tBodyAccJerk-Max-2', 'tBodyAccJerk-Max-3', 'tBodyAccJerk-Min-1', 'tBodyAccJerk-Min-2', 'tBodyAccJerk-Min-3', 'tBodyAccJerk-SMA-1', 'tBodyAccJerk-Energy-1', 'tBodyAccJerk-Energy-2', 'tBodyAccJerk-Energy-3', 'tBodyAccJerk-IQR-1', 'tBodyAccJerk-IQR-2', 'tBodyAccJerk-IQR-3', 'tBodyAccJerk-ropy-1', 'tBodyAccJerk-ropy-1.1', 'tBodyAccJerk-ropy-1.2', 'tBodyAccJerk-ARCoeff-1', 'tBodyAccJerk-ARCoeff-5', 'tBodyAccJerk-ARCoeff-6', 'tBodyAccJerk-ARCoeff-9', 'tBodyGyro-STD-1', 'tBodyGyro-STD-2', 'tBodyGyro-STD-3', 'tBodyGyro-Mad-1', 'tBodyGyro-Mad-2', 'tBodyGyro-Mad-3', 'tBodyGyro-Max-1', 'tBodyGyro-Max-2', 'tBodyGyro-Max-3', 'tBodyGyro-Min-1', 'tBodyGyro-Min-2', 'tBodyGyro-Min-3', 'tBodyGyro-SMA-1', 'tBodyGyro-Energy-1', 'tBodyGyro-Energy-2', 'tBodyGyro-Energy-3', 'tBodyGyro-IQR-1', 'tBodyGyro-IQR-2', 'tBodyGyro-IQR-3', 'tBodyGyro-ARCoeff-2', 'tBodyGyro-ARCoeff-6', 'tBodyGyro-ARCoeff-7', 'tBodyGyro-ARCoeff-10', 'tBodyGyro-ARCoeff-11', 'tBodyGyroJerk-STD-1', 'tBodyGyroJerk-STD-2', 'tBodyGyroJerk-STD-3', 'tBodyGyroJerk-Mad-1', 'tBodyGyroJerk-Mad-2', 'tBodyGyroJerk-Mad-3', 'tBodyGyroJerk-Max-1', 'tBodyGyroJerk-Max-2', 'tBodyGyroJerk-Max-3', 'tBodyGyroJerk-Min-1', 'tBodyGyroJerk-Min-2', 'tBodyGyroJerk-Min-3', 'tBodyGyroJerk-SMA-1', 'tBodyGyroJerk-Energy-1', 'tBodyGyroJerk-Energy-2', 'tBodyGyroJerk-Energy-3', 'tBodyGyroJerk-IQR-1', 'tBodyGyroJerk-IQR-2', 'tBodyGyroJerk-IQR-3', 'tBodyGyroJerk-ropy-1', 'tBodyGyroJerk-ropy-1.1', 'tBodyGyroJerk-ropy-1.2', 'tBodyGyroJerk-ARCoeff-1', 'tBodyGyroJerk-ARCoeff-5', 'tBodyGyroJerk-ARCoeff-7', 'tBodyGyroJerk-ARCoeff-9', 'tBodyGyroJerk-ARCoeff-10', 'tBodyAccMag-Mean-1', 'tBodyAccMag-STD-1', 'tBodyAccMag-Mad-1', 'tBodyAccMag-Max-1', 'tBodyAccMag-SMA-1', 'tBodyAccMag-Energy-1', 'tBodyAccMag-IQR-1', 'tBodyAccMag-ropy-1', 'tBodyAccMag-ARCoeff-2', 'tBodyAccMag-ARCoeff-4', 'tGravityAccMag-Mean-1', 'tGravityAccMag-STD-1', 'tGravityAccMag-Mad-1', 'tGravityAccMag-Max-1', 'tGravityAccMag-Min-1', 'tGravityAccMag-SMA-1', 'tGravityAccMag-Energy-1', 'tGravityAccMag-IQR-1', 'tGravityAccMag-ropy-1', 'tGravityAccMag-ARCoeff-1', 'tGravityAccMag-ARCoeff-2', 'tGravityAccMag-ARCoeff-3', 'tGravityAccMag-ARCoeff-4', 'tBodyAccJerkMag-Mean-1', 'tBodyAccJerkMag-STD-1', 'tBodyAccJerkMag-Mad-1', 'tBodyAccJerkMag-Max-1', 'tBodyAccJerkMag-Min-1', 'tBodyAccJerkMag-SMA-1', 'tBodyAccJerkMag-Energy-1', 'tBodyAccJerkMag-IQR-1', 'tBodyAccJerkMag-ropy-1', 'tBodyAccJerkMag-ARCoeff-2', 'tBodyGyroMag-Mean-1', 'tBodyGyroMag-STD-1', 'tBodyGyroMag-Mad-1', 'tBodyGyroMag-Max-1', 'tBodyGyroMag-Min-1', 'tBodyGyroMag-SMA-1', 'tBodyGyroMag-Energy-1', 'tBodyGyroMag-IQR-1', 'tBodyGyroMag-ARCoeff-2', 'tBodyGyroMag-ARCoeff-3', 'tBodyGyroMag-ARCoeff-4', 'tBodyGyroJerkMag-Mean-1', 'tBodyGyroJerkMag-STD-1', 'tBodyGyroJerkMag-Mad-1', 'tBodyGyroJerkMag-Max-1', 'tBodyGyroJerkMag-Min-1', 'tBodyGyroJerkMag-SMA-1', 'tBodyGyroJerkMag-Energy-1', 'tBodyGyroJerkMag-IQR-1', 'tBodyGyroJerkMag-ropy-1', 'tBodyGyroJerkMag-ARCoeff-2', 'fBodyAcc-Mean-1', 'fBodyAcc-Mean-2', 'fBodyAcc-Mean-3', 'fBodyAcc-STD-1', 'fBodyAcc-STD-2', 'fBodyAcc-STD-3', 'fBodyAcc-Mad-1', 'fBodyAcc-Mad-2', 'fBodyAcc-Mad-3', 'fBodyAcc-Max-1', 'fBodyAcc-Max-2', 'fBodyAcc-Max-3', 'fBodyAcc-SMA-1', 'fBodyAcc-Energy-1', 'fBodyAcc-Energy-2', 'fBodyAcc-Energy-3', 'fBodyAcc-IQR-1', 'fBodyAcc-IQR-2', 'fBodyAcc-IQR-3', 'fBodyAcc-ropy-1', 'fBodyAcc-ropy-1.1', 'fBodyAcc-ropy-1.2', 'fBodyAcc-Kurtosis-1', 'fBodyAcc-Kurtosis-1.1', 'fBodyAcc-Kurtosis-1.2', 'fBodyAcc-BandsEnergyOld-1', 'fBodyAcc-BandsEnergyOld-2', 'fBodyAcc-BandsEnergyOld-3', 'fBodyAcc-BandsEnergyOld-4', 'fBodyAcc-BandsEnergyOld-5', 'fBodyAcc-BandsEnergyOld-6', 'fBodyAcc-BandsEnergyOld-7', 'fBodyAcc-BandsEnergyOld-8', 'fBodyAcc-BandsEnergyOld-9', 'fBodyAcc-BandsEnergyOld-10', 'fBodyAcc-BandsEnergyOld-11', 'fBodyAcc-BandsEnergyOld-12', 'fBodyAcc-BandsEnergyOld-13', 'fBodyAcc-BandsEnergyOld-14', 'fBodyAcc-BandsEnergyOld-15', 'fBodyAcc-BandsEnergyOld-16', 'fBodyAcc-BandsEnergyOld-17', 'fBodyAcc-BandsEnergyOld-18', 'fBodyAcc-BandsEnergyOld-19', 'fBodyAcc-BandsEnergyOld-20', 'fBodyAcc-BandsEnergyOld-21', 'fBodyAcc-BandsEnergyOld-22', 'fBodyAcc-BandsEnergyOld-23', 'fBodyAcc-BandsEnergyOld-24', 'fBodyAcc-BandsEnergyOld-25', 'fBodyAcc-BandsEnergyOld-26', 'fBodyAcc-BandsEnergyOld-27', 'fBodyAcc-BandsEnergyOld-28', 'fBodyAcc-BandsEnergyOld-29', 'fBodyAcc-BandsEnergyOld-30', 'fBodyAcc-BandsEnergyOld-31', 'fBodyAcc-BandsEnergyOld-32', 'fBodyAcc-BandsEnergyOld-33', 'fBodyAcc-BandsEnergyOld-34', 'fBodyAcc-BandsEnergyOld-35', 'fBodyAcc-BandsEnergyOld-37', 'fBodyAcc-BandsEnergyOld-38', 'fBodyAcc-BandsEnergyOld-39', 'fBodyAcc-BandsEnergyOld-40', 'fBodyAcc-BandsEnergyOld-41', 'fBodyAcc-BandsEnergyOld-42', 'fBodyAccJerk-Mean-1', 'fBodyAccJerk-Mean-2', 'fBodyAccJerk-Mean-3', 'fBodyAccJerk-STD-1', 'fBodyAccJerk-STD-2', 'fBodyAccJerk-STD-3', 'fBodyAccJerk-Mad-1', 'fBodyAccJerk-Mad-2', 'fBodyAccJerk-Mad-3', 'fBodyAccJerk-Max-1', 'fBodyAccJerk-Max-2', 'fBodyAccJerk-Max-3', 'fBodyAccJerk-SMA-1', 'fBodyAccJerk-Energy-1', 'fBodyAccJerk-Energy-2', 'fBodyAccJerk-Energy-3', 'fBodyAccJerk-IQR-1', 'fBodyAccJerk-IQR-2', 'fBodyAccJerk-IQR-3', 'fBodyAccJerk-ropy-1', 'fBodyAccJerk-ropy-1.1', 'fBodyAccJerk-ropy-1.2', 'fBodyAccJerk-MeanFreq-1', 'fBodyAccJerk-MeanFreq-2', 'fBodyAccJerk-MeanFreq-3', 'fBodyAccJerk-Kurtosis-1', 'fBodyAccJerk-Kurtosis-1.1', 'fBodyAccJerk-Kurtosis-1.2', 'fBodyAccJerk-BandsEnergyOld-1', 'fBodyAccJerk-BandsEnergyOld-2', 'fBodyAccJerk-BandsEnergyOld-3', 'fBodyAccJerk-BandsEnergyOld-4', 'fBodyAccJerk-BandsEnergyOld-5', 'fBodyAccJerk-BandsEnergyOld-6', 'fBodyAccJerk-BandsEnergyOld-7', 'fBodyAccJerk-BandsEnergyOld-9', 'fBodyAccJerk-BandsEnergyOld-10', 'fBodyAccJerk-BandsEnergyOld-11', 'fBodyAccJerk-BandsEnergyOld-12', 'fBodyAccJerk-BandsEnergyOld-13', 'fBodyAccJerk-BandsEnergyOld-14', 'fBodyAccJerk-BandsEnergyOld-15', 'fBodyAccJerk-BandsEnergyOld-16', 'fBodyAccJerk-BandsEnergyOld-17', 'fBodyAccJerk-BandsEnergyOld-18', 'fBodyAccJerk-BandsEnergyOld-19', 'fBodyAccJerk-BandsEnergyOld-20', 'fBodyAccJerk-BandsEnergyOld-21', 'fBodyAccJerk-BandsEnergyOld-23', 'fBodyAccJerk-BandsEnergyOld-24', 'fBodyAccJerk-BandsEnergyOld-25', 'fBodyAccJerk-BandsEnergyOld-26', 'fBodyAccJerk-BandsEnergyOld-27', 'fBodyAccJerk-BandsEnergyOld-28', 'fBodyAccJerk-BandsEnergyOld-29', 'fBodyAccJerk-BandsEnergyOld-30', 'fBodyAccJerk-BandsEnergyOld-31', 'fBodyAccJerk-BandsEnergyOld-32', 'fBodyAccJerk-BandsEnergyOld-33', 'fBodyAccJerk-BandsEnergyOld-34', 'fBodyAccJerk-BandsEnergyOld-35', 'fBodyAccJerk-BandsEnergyOld-37', 'fBodyAccJerk-BandsEnergyOld-38', 'fBodyAccJerk-BandsEnergyOld-39', 'fBodyAccJerk-BandsEnergyOld-40', 'fBodyAccJerk-BandsEnergyOld-41', 'fBodyAccJerk-BandsEnergyOld-42', 'fBodyGyro-Mean-1', 'fBodyGyro-Mean-2', 'fBodyGyro-Mean-3', 'fBodyGyro-STD-1', 'fBodyGyro-STD-2', 'fBodyGyro-STD-3', 'fBodyGyro-Mad-1', 'fBodyGyro-Mad-2', 'fBodyGyro-Mad-3', 'fBodyGyro-Max-1', 'fBodyGyro-Max-2', 'fBodyGyro-Max-3', 'fBodyGyro-SMA-1', 'fBodyGyro-Energy-1', 'fBodyGyro-Energy-2', 'fBodyGyro-Energy-3', 'fBodyGyro-IQR-1', 'fBodyGyro-IQR-2', 'fBodyGyro-IQR-3', 'fBodyGyro-ropy-1', 'fBodyGyro-ropy-1.1', 'fBodyGyro-ropy-1.2', 'fBodyGyro-Kurtosis-1', 'fBodyGyro-Kurtosis-1.1', 'fBodyGyro-Kurtosis-1.2', 'fBodyGyro-BandsEnergyOld-1', 'fBodyGyro-BandsEnergyOld-2', 'fBodyGyro-BandsEnergyOld-3', 'fBodyGyro-BandsEnergyOld-4', 'fBodyGyro-BandsEnergyOld-5', 'fBodyGyro-BandsEnergyOld-6', 'fBodyGyro-BandsEnergyOld-7', 'fBodyGyro-BandsEnergyOld-8', 'fBodyGyro-BandsEnergyOld-9', 'fBodyGyro-BandsEnergyOld-10', 'fBodyGyro-BandsEnergyOld-11', 'fBodyGyro-BandsEnergyOld-12', 'fBodyGyro-BandsEnergyOld-13', 'fBodyGyro-BandsEnergyOld-14', 'fBodyGyro-BandsEnergyOld-15', 'fBodyGyro-BandsEnergyOld-16', 'fBodyGyro-BandsEnergyOld-17', 'fBodyGyro-BandsEnergyOld-18', 'fBodyGyro-BandsEnergyOld-19', 'fBodyGyro-BandsEnergyOld-20', 'fBodyGyro-BandsEnergyOld-21', 'fBodyGyro-BandsEnergyOld-23', 'fBodyGyro-BandsEnergyOld-24', 'fBodyGyro-BandsEnergyOld-25', 'fBodyGyro-BandsEnergyOld-26', 'fBodyGyro-BandsEnergyOld-27', 'fBodyGyro-BandsEnergyOld-28', 'fBodyGyro-BandsEnergyOld-29', 'fBodyGyro-BandsEnergyOld-30', 'fBodyGyro-BandsEnergyOld-31', 'fBodyGyro-BandsEnergyOld-32', 'fBodyGyro-BandsEnergyOld-33', 'fBodyGyro-BandsEnergyOld-34', 'fBodyGyro-BandsEnergyOld-36', 'fBodyGyro-BandsEnergyOld-37', 'fBodyGyro-BandsEnergyOld-38', 'fBodyGyro-BandsEnergyOld-39', 'fBodyGyro-BandsEnergyOld-40', 'fBodyGyro-BandsEnergyOld-41', 'fBodyGyro-BandsEnergyOld-42', 'fBodyAccMag-Mean-1', 'fBodyAccMag-STD-1', 'fBodyAccMag-Mad-1', 'fBodyAccMag-Max-1', 'fBodyAccMag-SMA-1', 'fBodyAccMag-Energy-1', 'fBodyAccMag-IQR-1', 'fBodyAccMag-ropy-1', 'fBodyAccMag-Kurtosis-1', 'fBodyAccJerkMag-Mean-1', 'fBodyAccJerkMag-STD-1', 'fBodyAccJerkMag-Mad-1', 'fBodyAccJerkMag-Max-1', 'fBodyAccJerkMag-SMA-1', 'fBodyAccJerkMag-Energy-1', 'fBodyAccJerkMag-IQR-1', 'fBodyAccJerkMag-ropy-1', 'fBodyAccJerkMag-Kurtosis-1', 'fBodyGyroMag-Mean-1', 'fBodyGyroMag-STD-1', 'fBodyGyroMag-Mad-1', 'fBodyGyroMag-Max-1', 'fBodyGyroMag-SMA-1', 'fBodyGyroMag-Energy-1', 'fBodyGyroMag-IQR-1', 'fBodyGyroMag-ropy-1', 'fBodyGyroMag-MeanFreq-1', 'fBodyGyroMag-Kurtosis-1', 'fBodyGyroJerkMag-Mean-1', 'fBodyGyroJerkMag-STD-1', 'fBodyGyroJerkMag-Mad-1', 'fBodyGyroJerkMag-Max-1', 'fBodyGyroJerkMag-Min-1', 'fBodyGyroJerkMag-SMA-1', 'fBodyGyroJerkMag-Energy-1', 'fBodyGyroJerkMag-IQR-1', 'fBodyGyroJerkMag-ropy-1', 'fBodyGyroJerkMag-Kurtosis-1', 'tXAxisAcc-AngleWRTGravity-1', 'tYAxisAcc-AngleWRTGravity-1', 'tZAxisAcc-AngleWRTGravity-1']
# Original Dataframe shape:  (7767, 562)
# Reduced DataFrame shape of threshold = 0.9: (7767, 213)
# Reduced DataFrame shape of threshold = 0.9: (7767, 146)
# %%
